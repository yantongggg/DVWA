# Command Injection (High Level)

## Vulnerability Overview

Input sanitization is added to DVWA's Command Injection module at the high-security level to prevent harmful characters. The code attempts to filter malicious input using a blacklist-based approach, aiming to prevent command chaining attacks.

### Weakness of the Filtering Method
- The filtering only removes a pipe (`|`) followed by a space.
- If an attacker uses a pipe **without** a space, the filter fails.
- Attackers can inject additional shell commands using `|command` format.
- This demonstrates poor input sanitization caused by overly specific filtering rules.

---

# Exploitation

To exploit this vulnerability, Burp Suite was used to intercept and modify HTTP POST requests when submitting the IP address field on DVWA.

## 1. File Disclosure

**Payload Used:**
```bash
127.0.0.1|cat /etc/passwd
```

### Result:
- The contents of the `/etc/passwd` file were printed in the HTTP response.
- This confirms that arbitrary system commands could be executed on the server.

---

## 2. Privilege Check

Upon executing shell commands through command injection, it was observed that the commands were executed under the `www-data` user.

### Significance:
- `www-data` is a low-privilege Apache web server user.
- Although restricted, it still allows attackers to read sensitive files and possibly pivot for further exploitation.

---

# âœ… Done!

This concludes the Command Injection exploitation on DVWA at high security level.
